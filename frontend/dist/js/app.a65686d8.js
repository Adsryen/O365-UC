(function(e){function t(t){for(var n,i,a=t[0],c=t[1],l=t[2],d=0,u=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&u.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);_&&_(t);while(u.length)u.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,i=1;i<r.length;i++){var c=r[i];0!==o[c]&&(n=!1)}n&&(s.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},o={app:0},s=[];function i(e){return a.p+"js/"+({about:"about"}[e]||e)+"."+{about:"cdad91fc"}[e]+".js"}function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.e=function(e){var t=[],r=o[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=n);var s,c=document.createElement("script");c.charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.src=i(e);var l=new Error;s=function(t){c.onerror=c.onload=null,clearTimeout(d);var r=o[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+s+")",l.name="ChunkLoadError",l.type=n,l.request=s,r[1](l)}o[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:c})}),12e4);c.onerror=c.onload=s,document.head.appendChild(c)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var _=l;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0156":function(e,t,r){"use strict";var n=r("44bd"),o=r.n(n);o.a},"44bd":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("99af"),r("4d63"),r("ac1f"),r("25f0"),r("466d"),r("e623"),r("e379"),r("5dc8"),r("37e1");var n=r("2b0e"),o=(r("d3b7"),r("bc3a")),s=r.n(o),i={},a=s.a.create(i);a.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),a.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)})),Plugin.install=function(e){e.axios=a,window.axios=a,Object.defineProperties(e.prototype,{axios:{get:function(){return a}},$axios:{get:function(){return a}}})},n["a"].use(Plugin);Plugin;var c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("router-view")},l=[],d={name:"App",components:{},data:function(){return{}}},_=d,u=r("2877"),p=Object(u["a"])(_,c,l,!1,null,null,null),m=p.exports,g=r("8c4f"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-col",[r("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[r("div",{staticClass:"d-flex align-center"},[r("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:"logo.ico",transition:"scale-transition",width:"40"}})],1),r("span",{staticClass:"title ml-3 mr-5"},[e._v("Office 365 Account Registration Portal")]),r("v-spacer"),r("v-btn",{attrs:{icon:"",color:"grey lighten-2",to:"/admin"}},[r("v-icon",[e._v("mdi-cog")])],1),r("v-btn",{attrs:{icon:"",color:"grey lighten-2"},on:{click:e.logoutGuest}},[r("v-icon",[e._v("mdi-exit-to-app")])],1)],1),r("v-main",[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"800px"}},[r("v-toolbar",{attrs:{color:"deep-purple accent-4",cards:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular",staticStyle:{color:"white"}},[e._v("Sign up")]),r("v-spacer")],1),r("v-form",{ref:"form",staticClass:"pa-4 pt-6",model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[r("v-container",[r("v-row",[r("v-text-field",{staticStyle:{"min-height":"96px max-width : 300"},attrs:{rules:[e.rules.username_rule,e.rules.length(1)],"error-messages":e.username_errormsg,filled:"",color:"deep-purple",label:"User Name",readonly:e.username_lock||e.username_lock_checking||e.submited,disabled:e.username_lock_checking,type:"User Name"},on:{input:e.usernameChange},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("v-text-field",{staticStyle:{"max-width":"40px"},attrs:{solo:"",outlined:"",color:"white",readonly:"","background-color":"white",value:"@"}}),r("v-select",{staticStyle:{"min-height":"96px"},attrs:{items:e.domains,filled:"",readonly:e.username_lock||e.username_lock_checking||e.submited,disabled:e.username_lock_checking,label:"Select Domain"},model:{value:e.selected_domain,callback:function(t){e.selected_domain=t},expression:"selected_domain"}}),r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.checkBtn_loading,disabled:e.checkBtn_disable,color:e.checkBtn_color},on:{click:e.checkName}},[e._v(" "+e._s(e.checkBtn_text)+" "),r("v-icon",{attrs:{right:"",dark:""}},[e._v(e._s(e.checkBtn_icon))])],1)],1)],1),r("v-container",[r("v-row",[r("v-text-field",{attrs:{rules:[e.rules.requiredStr],filled:"",color:"deep-purple",label:"First Name"},on:{input:e.FLnameChange},model:{value:e.givenName,callback:function(t){e.givenName=t},expression:"givenName"}}),r("v-text-field",{attrs:{rules:[e.rules.requiredStr],filled:"",color:"deep-purple",label:"Last Name"},on:{input:e.FLnameChange},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}}),r("v-autocomplete",{staticStyle:{"max-width":"120px"},attrs:{items:e.locatoinList,filled:"",label:"Location"},model:{value:e.usageLocation,callback:function(t){e.usageLocation=t},expression:"usageLocation"}}),r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.createBtn_loading,disabled:e.createBtn_disable,color:e.createBtn_color},on:{click:e.createUser}},[e._v(" "+e._s(e.createBtn_text)+" ")])],1)],1),r("v-container",[r("v-row",[r("v-text-field",{attrs:{rules:[e.rules.requiredStr],filled:"",color:"deep-purple",label:"Display Name"},model:{value:e.displayName,callback:function(t){e.displayName=t},expression:"displayName"}}),r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.updateBtn_loading,disabled:e.updateBtn_disable,color:e.updateBtn_color},on:{click:e.updateUser}},[e._v(" "+e._s(e.updateBtn_text)+" ")])],1)],1),r("v-container",[r("v-row",[r("v-select",{attrs:{items:e.licences,filled:"",label:"Select Licences","item-text":"skuPartNumber","item-value":"skuId"},model:{value:e.selected_licence,callback:function(t){e.selected_licence=t},expression:"selected_licence"}}),r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.addLicenceBtn_loading,disabled:e.addLicenceBtn_disable,color:e.addLicenceBtn_color},on:{click:e.addLicenceUser}},[e._v(" "+e._s(e.addLicenceBtn_text)+" ")])],1)],1),r("v-checkbox",{attrs:{rules:[e.rules.required],color:"deep-purple"},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(" I agree to the "),r("a",{attrs:{href:"https://portal.office.com/Commerce/Mosa.aspx",target:"_blank"}},[e._v("Terms of Service")]),e._v(" and "),r("a",{attrs:{href:"https://privacy.microsoft.com/zh-tw/privacystatement",target:"_blank"}},[e._v("Privacy Policy")]),e._v("* ")]},proxy:!0}]),model:{value:e.agreement,callback:function(t){e.agreement=t},expression:"agreement"}})],1),r("v-divider"),r("v-card-actions",[r("v-btn",{staticClass:"white--text",attrs:{disabled:e.accInfoBtn_disable,color:"deep-purple accent-4",depressed:""},on:{click:function(t){e.dialog=!0}}},[e._v("Account Info")]),e._e(),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{disabled:!e.form||!e.username_checked||e.submited,color:"deep-purple accent-4",depressed:""},on:{click:e.submitForm}},[e._v("Submit")])],1),r("v-dialog",{attrs:{absolute:"","max-width":"400",persistent:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",{staticClass:"headline grey lighten-3"},[e._v("Account Infomation")]),r("v-card-text",[e._v(" This is your account infomaion. This password will expire in 30 days, change it before expiration: ")]),r("v-card-text",[e._v(" Username: "+e._s(e.reg_username)+" "),r("br"),e._v(" Password: "+e._s(e.reg_password)+" "),r("br"),r("a",{attrs:{href:"https://www.office.com/?auth=2",target:"_blank"}},[e._v("Click me to login")])]),r("v-divider"),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{color:"deep-purple accent-4"},on:{click:function(t){e.dialog=!1}}},[e._v(" OK ")])],1)],1)],1)],1),r("v-overlay",{attrs:{opacity:"0.6",color:"black",value:!e.invite_success&&e.server_init_status}},[r("v-card",{staticClass:"mx-auto",attrs:{color:"white",light:"",loading:"true","min-width":"400",shaped:""}},[r("v-form",[r("v-col",[r("v-col",{staticClass:"CAPTCHAfield",attrs:{"ma-0":"","pa-0":"","no-gutters":"",align:"center"}},[r("v-text-field",{attrs:{color:"blue","error-messages":e.invite_errmsg,outlined:"",label:"Invite Code"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.SubmitInviteCode(t)}},model:{value:e.password_in,callback:function(t){e.password_in=t},expression:"password_in"}})],1),r("v-row",{attrs:{justify:"center"}},[r("v-btn",{attrs:{loading:e.invite_loading,color:"error"},on:{click:e.SubmitInviteCode}},[e._v(" Submit ")])],1)],1)],1)],1)],1),r("v-overlay",{attrs:{opacity:"0.9",color:"black",value:e.error_msg_bool}},[r("v-card",{staticClass:"mx-auto",attrs:{color:"red accent-1",loading:"true","min-width":"400",shaped:""}},[r("v-col",[r("p",{staticClass:"headline mb-1",attrs:{color:"green"}},[e._v(e._s(e.error_msg_title))]),r("v-card-text",{attrs:{color:"green"},domProps:{innerHTML:e._s(e.error_msg)}}),r("v-row",{attrs:{justify:"center"}},[r("v-btn",{attrs:{color:"error"},on:{click:function(t){e.error_msg_bool=!1}}},[e._v(" OK ")])],1)],1)],1)],1),r("v-overlay",{attrs:{opacity:"0.6",color:"black",value:!e.server_init_status}},[r("v-card",{staticClass:"mx-auto",attrs:{light:"",color:e.server_init_pending?void 0:"red","min-width":"400",shaped:"",loading:e.server_init_pending}},[r("v-col",[r("p",{staticClass:"headline mb-1",attrs:{color:"green"}},[e._v(e._s(e.server_init_status_title))]),r("v-card-text",{attrs:{color:"green"},domProps:{innerHTML:e._s(e.server_init_status_text)}}),r("v-row",{attrs:{justify:"center"}},[e.server_init_pending?e._e():r("v-btn",{attrs:{color:"error",to:"/admin"}},[e._v(" admin panel ")])],1)],1)],1)],1)],1)],1)],1)},h=[],v=(r("5319"),r("1276"),r("04ac")),C=r.n(v),A=r("b047"),b=r.n(A),k=s.a.create();C()(k,{retries:3,retryDelay:function(){return 500}});var T={props:{source:String},data:function(){return{url_base:location.origin,cookie_prefix:"o365_ucg",CAPTCHA_response_name:"",CAPTCHA_frontend_head_html:"",CAPTCHA_frontend_login_html:"",invite_success:!1,invite_loading:!1,invite_errmsg:"",error_msg_bool:!1,error_msg_title:"Error",error_msg:"Error message here!",password_in:"anonymous",usageLocation:"US",locatoinList:["AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","XK","YE","YT","ZA","ZM","ZW"],agreement:!1,dialog:!1,form:!1,username:"",username_checked:!1,username_lock:!1,username_lock_checking:!1,username_errormsg:"",displayName:"",givenName:"",surname:"",reg_username:"",reg_password:"",checkBtn_text:"Check",checkBtn_icon:"mdi-magnify",checkBtn_color:"blue",checkBtn_loading:!1,createBtn_text:"Pending",createBtn_color:"green",createBtn_loading:!1,createBtn_disable_1:!0,updateBtn_text:"Pending",updateBtn_color:"green",updateBtn_loading:!1,updateBtn_disable_1:!0,addLicenceBtn_text:"Pending",addLicenceBtn_color:"green",addLicenceBtn_loading:!1,addLicenceBtn_disable_1:!0,submited:!1,server_init_pending:!0,server_init_status:!1,server_init_status_title:"Connecting to Server",server_init_status_text:"Checking server token status.<br/>Please wait....",domains:["1.example.com","2.example.com","3.example.com","4.example.com"],selected_domain:void 0,licences:[{skuPartNumber:"A1",skuId:"00121"},{skuPartNumber:"A2",skuId:"00122"},{skuPartNumber:"A3",skuId:"00123"},{skuPartNumber:"A4",skuId:"00124"}],selected_licence:void 0,rules:{length:function(e){return function(t){return(t||"").length>=e||"Required length:".concat(e)}},username_rule:function(e){return null!==(e||"").match(/^[a-zA-Z0-9]+$/)||"Only letters and numbers"},required:function(e){return!!e||"This field is required"},requiredStr:function(e){return 0!==e.length||"This field is required"}}}},computed:{api_path:function(){return this.url_base+"/api/"},userPrincipalName:function(){return this.username+"@"+this.selected_domain},checkBtn_disable:function(){return this.checkBtn_loading||0==this.username.length||!0!==this.rules.username_rule(this.username)||this.submited},createBtn_disable:function(){return this.createBtn_disable_1||this.createBtn_loading||!this.submited},updateBtn_disable:function(){return this.updateBtn_disable_1||this.updateBtn_loading||!this.submited},addLicenceBtn_disable:function(){return this.addLicenceBtn_disable_1||this.addLicenceBtn_loading||!this.submited},accInfoBtn_disable:function(){return 0===this.reg_username.length}},mounted:function(){this.check_init()},methods:{SubmitInviteCode:function(){var e=this;if(""===this.CAPTCHA_response_name||document.getElementsByName(this.CAPTCHA_response_name)[0].value.length>0){this.invite_loading=!0;var t=document.getElementsByName(this.CAPTCHA_response_name).length>0?document.getElementsByName(this.CAPTCHA_response_name)[0].value:"undefined";s.a.post(this.api_path+"guestlogin",null,{params:{password:this.password_in,CAPTCHA:t}}).then((function(t){e.$setCookie(e.cookie_prefix+"session_id",t.data["session_id"]),e.invite_success=!0,e.updatePage()})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?e.invite_errmsg=t.response.data["error"]+": "+t.response.data["error_description"]:e.invite_errmsg=t.response.data:(console.log(t),e.invite_errmsg="Network Error.")})).finally((function(){e.invite_loading=!1}))}else e.error_msg_bool=!0,e.error_msg_title="Captcha Required",e.error_msg="Please verify that you are not a robot."},logoutGuest:function(){var e=this;s.a.delete(e.api_path+"guestlogin",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.$setCookie(e.cookie_prefix+"session_id",t.data["session_id"]),window.location.reload(),e.updatePage()})).catch((function(t){t.response?401===t.response.status?e.login_errmsg=t.response.data.error_description:e.login_errmsg="Error code:"+t.response.status:(console.log(t),e.login_errmsg="Network Error.")})).finally((function(){e.updatePage()}))},check_init:function(){var e=this;s.a.get(this.api_path+"testInit").then((function(t){1==t.data?(e.server_init_status=!0,e.updatePage()):(e.server_init_status=!1,e.server_init_status_title="Invalid Server Token",e.server_init_status_text="Please contact admin to grent permissions.")})).catch((function(t){console.log(t),t.response?(e.server_init_status=!1,e.server_init_status_title="Invalid Server Token",e.server_init_status_text="Please contact admin to grent permissions."):(e.server_init_status=!1,e.server_init_status_title="Connection Error",e.server_init_status_text="Unable to connect to the server.")})).finally((function(){e.server_init_pending=!1}))},updateCAPTCHA:function(){},updatePage:function(){var e=this;""===e.CAPTCHA_response_name&&s.a.get(this.api_path+"login",{params:{get_CAPTCHA:"g"}}).then((function(t){e.CAPTCHA_response_name=t.data["CAPTCHA_front_end_response_field"],e.CAPTCHA_frontend_head_html=t.data["CAPTCHA_frontend_head_html"],e.CAPTCHA_frontend_login_html=t.data["CAPTCHA_frontend_login_html"],document.getElementsByTagName("head")[0].appendChild(document.createRange().createContextualFragment(e.CAPTCHA_frontend_head_html)),document.getElementsByClassName("CAPTCHAfield")[0].appendChild(document.createRange().createContextualFragment(e.CAPTCHA_frontend_login_html))})).catch((function(e){console.log(e)})),s.a.get(this.api_path+"getRegInfo",{params:{guest_session_id:this.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.invite_success=!0,e.domains=t.data["availableDomains"],e.licences=t.data["availableLicences"],e.selected_domain=e.selected_domain||e.domains[0],e.selected_licence=e.selected_licence||e.licences[0]["skuId"],e.updatePage2()})).catch((function(t){console.log(t),e.invite_success=!1,e.updateCAPTCHA()}))},updatePage2:function(){var e=this;s.a.get(this.api_path+"guestlogin",{params:{session_id:this.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){void 0!==t.data["userPrincipalName"]&&(e.username=t.data["userPrincipalName"].split("@")[0],e.selected_domain=t.data["userPrincipalName"].split("@")[1],e.displayName=t.data["displayName"],e.submited=!0,e.checkBtn_color="green",e.checkBtn_icon="mdi-check-outline",e.checkBtn_text="OK",e.agreement=!0,e.createBtn_disable_1=!1,e.updateBtn_disable_1=!1,e.addLicenceBtn_disable_1=!1),void 0!==t.data["regResult"]&&(e.reg_username=t.data["regResult"]["username"],e.reg_password=t.data["regResult"]["password"],e.createBtn_text="Success",void 0!==t.data["infomation"]?(e.givenName=t.data["infomation"]["givenName"],e.surname=t.data["infomation"]["surname"],e.usageLocation=t.data["infomation"]["usageLocation"],e.updateBtn_text="Success"):(e.updateBtn_text="Retry",e.updateBtn_color="red"),void 0!==t.data["addLicensesID"]?(e.selected_licence=t.data["addLicensesID"],e.addLicenceBtn_text="Success"):(e.addLicenceBtn_text="Retry",e.addLicenceBtn_color="red"))})).catch((function(){e.invite_success=!1}))},checkName:function(){if(0!=this.username.length&&1==this.rules.username_rule(this.username)){var e=this;e.checkBtn_loading=!0,e.username_lock_checking=!0,s.a.get(this.api_path+"canReg",{params:{guest_session_id:this.$getCookie(e.cookie_prefix+"session_id"),userPrincipalName:e.userPrincipalName}}).then((function(t){"True"===t.data?(e.checkBtn_color="green",e.checkBtn_icon="mdi-check-outline",e.checkBtn_text="OK",e.username_errormsg="",e.username_checked=!0):(e.checkBtn_color="red",e.checkBtn_icon="mdi-close-outline",e.checkBtn_text="Exists",e.username_errormsg="Username exists",e.username_checked=!1)})).catch((function(t){t.response?409===t.response.status?(e.checkBtn_color="red",e.checkBtn_icon="mdi-close-outline",e.checkBtn_text="Exists",e.username_errormsg="Username exists",e.username_checked=!1):void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString(),e.error_msg_bool=!0),console.log(t)})).finally((function(){e.checkBtn_loading=!1,e.username_lock_checking=!1}))}},usernameChange:function(){this.username_checked=!1,this.username_errormsg="",this.delayCheckName()},delayCheckName:b()((function(){this.checkName()}),2400),FLnameChange:function(){""!=this.givenName&&""!=this.surname&&(this.displayName=this.givenName+" "+this.surname)},createUser:function(){var e=this;e.createBtn_disable_1=!1,this.createBtn_loading=!0;var t={guest_session_id:e.$getCookie(e.cookie_prefix+"session_id"),userPrincipalName:e.userPrincipalName,displayName:e.displayName};s.a.post(this.api_path+"createUser",null,{params:t}).then((function(t){e.createBtn_text="Success",e.createBtn_color="green",e.reg_username=t.data["username"],e.reg_password=t.data["password"],e.updateUser(event,5,!0)})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,e.createBtn_text="Retry",e.createBtn_color="red",console.log(t)})).finally((function(){e.createBtn_loading=!1,e.updateBtn_disable_1=!1}))},updateUser:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log("retry left:"+t),!0===r&&(this.updateBtn_loading=!0);var n=this,o={givenName:n.givenName,surname:n.surname,usageLocation:n.usageLocation},s={guest_session_id:n.$getCookie(n.cookie_prefix+"session_id"),infomation:JSON.stringify(o)};k.put(this.api_path+"updateUser",null,{params:s}).then((function(){n.updateBtn_text="Success",n.updateBtn_color="green",n.updateBtn_loading=!1,n.addLicenceBtn_disable_1=!1,n.addLicenceUser(e,5,!0)})).catch((function(r){t>0?setTimeout(n.updateUser,1e3,e,t-1,!1):(r.response?void 0!=r.response.data["error_description"]?(n.error_msg_title=r.response.data["error"],n.error_msg=r.response.data["error_description"].replace(/\n/g,"<br/>")):(n.error_msg_title="Error",n.error_msg=r.response.data):(n.error_msg_title="Error",n.error_msg=r.toString()),n.error_msg_bool=!0,n.updateBtn_text="Retry",n.updateBtn_color="red",n.updateBtn_loading=!1,n.addLicenceBtn_disable_1=!1,console.log(r))})).finally((function(){}))},addLicenceUser:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log("retry left:"+t),!0===r&&(this.addLicenceBtn_loading=!0);var n=this,o={guest_session_id:n.$getCookie(n.cookie_prefix+"session_id"),addLicensesID:n.selected_licence};console.log(o),k.post(this.api_path+"assignLicense",null,{params:o}).then((function(){n.addLicenceBtn_text="Success",n.addLicenceBtn_color="green",n.addLicenceBtn_loading=!1,n.dialog=!0})).catch((function(r){t>0?setTimeout(n.addLicenceUser,1e3,e,t-1,!1):(r.response?void 0!=r.response.data["error_description"]?(n.error_msg_title=r.response.data["error"],n.error_msg=r.response.data["error_description"].replace(/\n/g,"<br/>")):(n.error_msg_title="Error",n.error_msg=r.response.data):(n.error_msg_title="Error",n.error_msg=r.toString()),n.error_msg_bool=!0,n.addLicenceBtn_text="Retry",n.addLicenceBtn_color="red",console.log(r),n.addLicenceBtn_loading=!1)})).finally((function(){}))},submitForm:function(){this.submited=!0,this.createUser()},testFunc:function(){console.log(this.selected_licence)}}},P=T,x=r("6544"),y=r.n(x),w=r("7496"),H=r("40dc"),S=r("c6a6"),B=r("8336"),I=r("b0af"),L=r("99d9"),N=r("ac7c"),E=r("62ad"),R=r("a523"),D=r("169a"),G=r("ce7e"),O=r("4bd4"),U=r("132d"),V=r("adda"),M=r("f6c4"),j=r("a797"),$=r("0fd9b"),F=r("b974"),K=r("2fa4"),q=r("8654"),J=r("71d9"),W=Object(u["a"])(P,f,h,!1,null,null,null),Z=W.exports;y()(W,{VApp:w["a"],VAppBar:H["a"],VAutocomplete:S["a"],VBtn:B["a"],VCard:I["a"],VCardActions:L["a"],VCardText:L["b"],VCardTitle:L["c"],VCheckbox:N["a"],VCol:E["a"],VContainer:R["a"],VDialog:D["a"],VDivider:G["a"],VForm:O["a"],VIcon:U["a"],VImg:V["a"],VMain:M["a"],VOverlay:j["a"],VRow:$["a"],VSelect:F["a"],VSpacer:K["a"],VTextField:q["a"],VToolbar:J["a"]});var Y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"keep"}},[r("v-app-bar",{attrs:{app:"","clipped-left":"",color:"amber"}},[r("v-app-bar-nav-icon",{on:{click:function(t){e.drawer=!e.drawer}}}),r("span",{staticClass:"title ml-3 mr-5"},[e._v("Office 365 Account Registration Portal "),r("span",{staticClass:"font-weight-light"},[e._v("Admin Panel")])]),r("v-spacer"),r("v-btn",{attrs:{icon:"",color:"grey lighten-2",to:"/"}},[r("v-icon",[e._v("mdi-account-plus")])],1),r("v-btn",{attrs:{icon:"",color:"grey lighten-2"},on:{click:e.logoutAdmin}},[r("v-icon",[e._v("mdi-exit-to-app")])],1)],1),r("v-navigation-drawer",{attrs:{app:"",clipped:"",color:"grey lighten-4"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-list",{staticClass:"grey lighten-4",attrs:{dense:""}},[e._l(e.items,(function(t,n){return[t.divider?r("v-divider",{key:n,staticClass:"my-4"}):r("v-list-item",{key:n,attrs:{link:""}},[r("v-list-item-action",[r("v-icon",[e._v(e._s(t.icon))])],1),r("v-list-item-content",[r("v-list-item-title",{staticClass:"grey--text"},[e._v(" "+e._s(t.text)+" ")])],1)],1)]}))],2)],1),r("v-main",[r("v-container",{staticClass:"grey lighten-4",attrs:{fluid:""}},[r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Application Infomation")]),r("v-col",[r("v-form",{model:{value:e.form_appinfo,callback:function(t){e.form_appinfo=t},expression:"form_appinfo"}},[r("v-text-field",{attrs:{label:"App Name",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.appName,callback:function(t){e.appName=t},expression:"appName"}}),r("v-text-field",{attrs:{label:"Code Receive URI",rules:[e.checkHTTPS]},model:{value:e.redirect_uri,callback:function(t){e.redirect_uri=t},expression:"redirect_uri"}}),r("v-row",{attrs:{justify:"end"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{color:e.setInfo_color,loading:e.setInfo_loading,disabled:e.setInfo_disabled},on:{click:e.setInfo}},[e._v(" Save "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.setInfo_icon))])],1)],1)],1)],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Client ID and Secret")]),r("v-col",[r("v-row",{attrs:{justify:"start"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{rounded:"",color:"primary"},on:{click:e.prepareRedirect2GetSecretUrl}},[e._v(" Prepare ")]),r("v-btn",{staticClass:"ma-2 white--text",attrs:{rounded:"",disabled:e.redirect2GetSecretUrl_disabled,color:"primary",target:"_blank",href:e.redirect2GetSecretUrl_url}},[e._v(" Get Client ID and Secret ")])],1),r("v-text-field",{attrs:{label:"Secret",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.secret,callback:function(t){e.secret=t},expression:"secret"}}),r("v-text-field",{attrs:{label:"Client ID",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.client_id,callback:function(t){e.client_id=t},expression:"client_id"}}),r("v-row",{attrs:{justify:"end"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.CIDaS_loading,disabled:e.CIDaS_loading,color:e.CIDaS_color},on:{click:e.CIDaS}},[e._v(" Save "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.CIDaS_icon))])],1)],1)],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Grant Permission and Get Code")]),r("v-col",[r("v-row",{attrs:{justify:"start"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{rounded:"",loading:e.prepareRedirect2GetCodeUrl_loading,disabled:e.prepareRedirect2GetCodeUrl_loading,color:"primary"},on:{click:e.prepareRedirect2GetCodeUrl}},[e._v(" Prepare ")]),r("v-btn",{staticClass:"ma-2 white--text",attrs:{rounded:"",disabled:e.redirect2GetCodeUrl_disabled,color:"primary",target:"_blank",href:e.redirect2GetCodeUrl_url}},[e._v(" Grant Permissoins ")])],1),r("v-text-field",{attrs:{label:"Code"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),r("v-row",{attrs:{justify:"start"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.InitToken_loading,disabled:e.InitToken_disabled,color:e.InitToken_color},on:{click:e.initToken}},[e._v(" Initialize token by this code "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.InitToken_icon))])],1)],1)],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Token")]),r("v-col",[r("v-row",{attrs:{justify:"start"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.RefreshToken_loading,disabled:e.RefreshToken_loading,color:"green"},on:{click:e.refreshToken}},[e._v(" Force Refresh Token ")])],1),r("v-text-field",{attrs:{label:"Access Token"},model:{value:e.access_token,callback:function(t){e.access_token=t},expression:"access_token"}}),r("v-text-field",{attrs:{label:"Refresh Token"},model:{value:e.refresh_token,callback:function(t){e.refresh_token=t},expression:"refresh_token"}})],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Guest Settings")]),r("v-col",[r("v-btn",{staticClass:"ma-2 white--text",attrs:{color:"green",loading:e.RefreshRegInfo_loading,disabled:e.RefreshRegInfo_loading},on:{click:e.refreshRegInfo}},[e._v(" Refresh List "),r("v-icon",{attrs:{right:""}},[e._v("mdi-autorenew")])],1),r("v-row",{attrs:{justify:"start"}},[r("v-col",[r("v-text-field",{attrs:{color:"blue","error-messages":e.domain_select_errmsg,readonly:"",solo:"",flat:"",value:"Registerable Domains"}}),e._l(e.domains,(function(t,n){return r("v-container",{key:n,attrs:{fluid:""}},[r("v-switch",{attrs:{label:t,value:t},model:{value:e.selected_domains,callback:function(t){e.selected_domains=t},expression:"selected_domains"}})],1)}))],2),r("v-col",[r("v-text-field",{attrs:{color:"blue","error-messages":e.domain_select_errmsg,readonly:"",solo:"",flat:"",value:"Registerable Licences"}}),e._l(e.licences,(function(t,n){return r("v-container",{key:n,attrs:{fluid:""}},[r("v-switch",{attrs:{label:t.skuPartNumber,value:t},on:{change:function(t){e.maxAllowedLicense=Math.max(1,Math.min(e.maxAllowedLicense,e.selected_licences.length))}},model:{value:e.selected_licences,callback:function(t){e.selected_licences=t},expression:"selected_licences"}})],1)})),r("v-row",[r("v-select",{attrs:{items:e.maxAllowedLicenseList,filled:"",label:"Max allowed License"},model:{value:e.maxAllowedLicense,callback:function(t){e.maxAllowedLicense=t},expression:"maxAllowedLicense"}})],1)],2)],1),r("v-row",{attrs:{justify:"end"}},[r("v-card-actions",[r("v-btn",{staticClass:"ma-2 white--text",attrs:{disabled:e.setDomainsAndLicences_disable,loading:e.setDomainsAndLicences_loading,color:e.setDomainsAndLicences_color},on:{click:e.setDomainsAndLicences}},[e._v(" Save "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.setDomainsAndLicences_icon))])],1)],1)],1)],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("CAPTCHA Settings")]),r("v-col",[r("v-switch",{attrs:{label:"Enable CAPTCHA for guest invite code redemption"},model:{value:e.CAPTCHA_enable_g,callback:function(t){e.CAPTCHA_enable_g=t},expression:"CAPTCHA_enable_g"}}),r("v-switch",{attrs:{label:"Enable CAPTCHA for admin panel login"},model:{value:e.CAPTCHA_enable_p,callback:function(t){e.CAPTCHA_enable_p=t},expression:"CAPTCHA_enable_p"}}),r("v-text-field",{attrs:{label:"Frontend CAPTCHA form field id",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.CAPTCHA_front_end_response_field,callback:function(t){e.CAPTCHA_front_end_response_field=t},expression:"CAPTCHA_front_end_response_field"}}),r("v-text-field",{attrs:{label:"Frontend HTML injection (HEAD)",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.CAPTCHA_frontend_head_html,callback:function(t){e.CAPTCHA_frontend_head_html=t},expression:"CAPTCHA_frontend_head_html"}}),r("v-text-field",{attrs:{label:"Frontend HTML injection (FORM)",rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.CAPTCHA_frontend_login_html,callback:function(t){e.CAPTCHA_frontend_login_html=t},expression:"CAPTCHA_frontend_login_html"}}),r("v-textarea",{attrs:{"auto-grow":"",label:"Backend verify api request paramaters",code_text:"",spellcheck:"false",rules:[e.CAPTCHA_verify_api_pass]},on:{input:e.CAPTCHA_verify_api_change},model:{value:e.CAPTCHA_verify_api,callback:function(t){e.CAPTCHA_verify_api=t},expression:"CAPTCHA_verify_api"}}),r("v-textarea",{attrs:{"auto-grow":"",label:"Backend verify api response check function (ECMAScript 5.1)",code_text:"",spellcheck:"false",rules:[e.CAPTCHA_verify_func_pass]},on:{input:e.CAPTCHA_verify_func_change},model:{value:e.CAPTCHA_verify_func,callback:function(t){e.CAPTCHA_verify_func=t},expression:"CAPTCHA_verify_func"}}),r("v-row",{attrs:{justify:"end"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.setCAPTCHA_loading,disabled:e.setCAPTCHA_loading||0===e.CAPTCHA_front_end_response_field.length||0===e.CAPTCHA_frontend_head_html.length||0===e.CAPTCHA_frontend_login_html.length||!0!==e.CAPTCHA_verify_api_pass_btn||!0!==e.CAPTCHA_verify_func_pass_btn,color:e.setCAPTCHA_color},on:{click:e.setCAPTCHA}},[e._v(" Save "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.setCAPTCHA_icon))])],1)],1)],1)],1)],1)],1),r("v-card",{staticClass:"mx-auto",attrs:{"max-width":"3440000",outlined:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Settings")]),r("v-col",[r("v-text-field",{attrs:{color:"blue","error-messages":e.domain_select_errmsg,readonly:"",solo:"",flat:"",value:"Change Password"}}),r("v-text-field",{attrs:{label:"Old password",type:e.old_password_type,rules:[function(e){return 0!==e.length||"This field is required"}]},model:{value:e.Old_password,callback:function(t){e.Old_password=t},expression:"Old_password"}}),r("v-text-field",{attrs:{label:"new password",type:"password",rules:[function(e){return e.length>=6||"Password length must >= 6"}]},model:{value:e.New_password,callback:function(t){e.New_password=t},expression:"New_password"}}),r("v-row",{attrs:{justify:"end"}},[r("v-btn",{staticClass:"ma-2 white--text",attrs:{loading:e.setPassword_loading,disabled:e.setPassword_loading||0==e.Old_password.length||e.New_password.length<6,color:e.setPassword_color},on:{click:e.setPassword}},[e._v(" Save "),r("v-icon",{attrs:{right:""}},[e._v(e._s(e.setPassword_icon))])],1)],1)],1)],1)],1)],1),r("v-overlay",{attrs:{opacity:"0.9",color:"black",value:!e.login_success}},[r("v-card",{staticClass:"mx-auto",attrs:{color:"white",light:"",loading:"true","min-width":"400",shaped:""}},[r("v-col",[r("v-col",{staticClass:"CAPTCHAfield",attrs:{"ma-0":"","pa-0":"","no-gutters":"",align:"center"}},[r("v-text-field",{attrs:{color:"blue","error-messages":e.login_errmsg,type:"password",outlined:"",label:"Password"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.password_in,callback:function(t){e.password_in=t},expression:"password_in"}})],1),r("v-row",{attrs:{justify:"center"}},[r("v-btn",{attrs:{loading:e.login_loading,disabled:e.login_loading,color:"error"},on:{click:e.login}},[e._v(" Login ")])],1)],1)],1)],1),r("v-overlay",{attrs:{opacity:"0.9",color:"black",value:e.error_msg_bool}},[r("v-card",{staticClass:"mx-auto",attrs:{color:"red accent-1",loading:"true","min-width":"400",shaped:""}},[r("v-col",[r("p",{staticClass:"headline mb-1",attrs:{color:"green"}},[e._v(e._s(e.error_msg_title))]),r("v-card-text",{attrs:{color:"green"},domProps:{innerHTML:e._s(e.error_msg)}}),r("v-row",{attrs:{justify:"center"}},[r("v-btn",{attrs:{color:"error"},on:{click:function(t){e.error_msg_bool=!1}}},[e._v(" OK ")])],1)],1)],1)],1)],1)],1)],1)},Q=[],X=(r("c975"),r("d81d"),r("2ca0"),r("ddb0"),r("2909")),z={props:{source:String},data:function(){return{url_base:location.origin,cookie_prefix:"o365_uca",form_appinfo:!1,CAPTCHA_response_name:"",CAPTCHA_enable_p:!1,CAPTCHA_enable_g:!1,CAPTCHA_front_end_response_field:"g-recaptcha-response",CAPTCHA_verify_api:JSON.stringify({url:"https://www.google.com/recaptcha/api/siteverify",method:"POST",url_params:{secret:"6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe",response:"__front_end_response__"},body_params:{},headers:{"Content-Type":"application/x-www-form-urlencoded"}},null,4),CAPTCHA_verify_api_pass:!0,CAPTCHA_verify_api_pass_btn:!0,CAPTCHA_verify_func:'function(HTTPResponse) {\n    if(HTTPResponse.code < 200 || HTTPResponse.code >= 400){\n        return "Bed response code: " + HTTPResponse.code;\n    }\n    else{\n        response_json = JSON.parse(HTTPResponse.body.decode("utf8"))\n        if(response_json["success"] === true){\n            return true;\n        }\n        return "CAPTCHA failed: " + JSON.stringify(response_json["error-codes"]);\n    } \n}',CAPTCHA_verify_func_pass:!0,CAPTCHA_verify_func_pass_btn:!0,CAPTCHA_frontend_head_html:"<script src='https://www.google.com/recaptcha/api.js'> </ script>",CAPTCHA_frontend_login_html:"<div class='g-recaptcha' data-sitekey=6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI></div>",password_in:"",Old_password:"",New_password:"",login_loading:!1,login_success:!1,login_errmsg:"",setInfo_loading:!1,setInfo_color:"blue",setInfo_icon:"mdi-cloud-upload",CIDaS_loading:!1,CIDaS_color:"red",CIDaS_icon:"mdi-cloud-upload",redirect2GetSecretUrl_url:void 0,prepareRedirect2GetCodeUrl_loading:!1,redirect2GetCodeUrl_url:void 0,InitToken_loading:!1,InitToken_color:"blue",InitToken_icon:"mdi-autorenew",RefreshToken_loading:!1,RefreshRegInfo_loading:!1,domain_select_errmsg:"",setDomainsAndLicences_loading:!1,setDomainsAndLicences_icon:"mdi-cloud-upload",setDomainsAndLicences_color:"blue",Admin_setting_loading:!1,Admin_setting_color:"blue",Admin_setting_icon:"mdi-cloud-upload",setCAPTCHA_loading:!1,setCAPTCHA_color:"blue",setCAPTCHA_icon:"mdi-cloud-upload",old_password_type:"password",setPassword_loading:!1,setPassword_color:"blue",setPassword_icon:"mdi-cloud-upload",appName:"",redirect_uri:"",maxAllowedLicense:1,secret:"",client_id:"",code:"",access_token:"",refresh_token:"",error_msg_bool:!1,error_msg_title:"Error",error_msg:"Error message here!",drawer:null,items:[{icon:"mdi-information",text:"App Info"},{icon:"mdi-key",text:"Client ID and Secret"},{divider:!0},{icon:"mdi-qrcode-plus",text:"Grant permission"},{icon:"mdi-ticket",text:"Token"},{divider:!0},{icon:"mdi-account-plus",text:"Guest Settings"},{icon:"mdi-robot",text:"CAPTCHA Settings"},{icon:"mdi-cog",text:"Settings"}],domains:["1.example.com","2.example.com","3.example.com","4.example.com"],selected_domains:["1.example.com","2.example.com"],licences:[{skuPartNumber:"A1",skuId:"00121"},{skuPartNumber:"A2",skuId:"00122"},{skuPartNumber:"A3",skuId:"00123"}],selected_licences:[{skuPartNumber:"A1",skuId:"00121"},{skuPartNumber:"A3",skuId:"00123"}]}},computed:{api_path:function(){return this.url_base+"/api/"},setInfo_disabled:function(){return!this.form_appinfo||this.setInfo_loading},redirect2GetCodeUrl_disabled:function(){return void 0===this.redirect2GetCodeUrl_url},redirect2GetSecretUrl_disabled:function(){return void 0===this.redirect2GetSecretUrl_url},InitToken_disabled:function(){return this.InitToken_loading||0===this.code.length},setDomainsAndLicences_disable:function(){return this.setDomainsAndLicences_loading||0===this.selected_domains.length||0===this.selected_licences.length},maxAllowedLicenseList:function(){return Object(X["a"])(Array(this.selected_licences.length).keys()).map((function(e){return e+1}))}},mounted:function(){this.updatePage()},methods:{checkHTTPS:function(e){return!!e.startsWith("https://")||"Redirect URI must start with 'https://' due to Microsoft's GraphAPI restriction."},login:function(){var e=this;if(""===this.CAPTCHA_response_name||document.getElementsByName(this.CAPTCHA_response_name)[0].value.length>0){this.login_loading=!0;var t=document.getElementsByName(this.CAPTCHA_response_name).length>0?document.getElementsByName(this.CAPTCHA_response_name)[0].value:"undefined";s.a.post(this.api_path+"login",null,{params:{password:this.password_in,CAPTCHA:t}}).then((function(t){e.$setCookie(e.cookie_prefix+"session_id",t.data["session_id"]),e.updatePage()})).catch((function(t){t.response?401===t.response.status?e.login_errmsg=t.response.data.error_description:e.login_errmsg="Error code:"+t.response.status:(console.log(t),e.login_errmsg="Network Error.")})).finally((function(){e.login_loading=!1}))}else e.error_msg_bool=!0,e.error_msg_title="Captcha Required",e.error_msg="Please verify that you are not a robot."},logoutAdmin:function(){var e=this;s.a.delete(e.api_path+"login",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.$setCookie(e.cookie_prefix+"session_id",t.data["session_id"]),e.updatePage()})).catch((function(t){t.response?401===t.response.status?e.login_errmsg=t.response.data.error_description:e.login_errmsg="Error code:"+t.response.status:(console.log(t),e.login_errmsg="Network Error.")})).finally((function(){e.$delCookie(e.cookie_prefix+"session_id"),window.location.reload()}))},updatePage:function(){var e=this;""===e.CAPTCHA_response_name&&s.a.get(this.api_path+"login",{params:{get_CAPTCHA:"p"}}).then((function(t){document.getElementsByTagName("head")[0].appendChild(document.createRange().createContextualFragment(t.data["CAPTCHA_frontend_head_html"])),document.getElementsByClassName("CAPTCHAfield")[0].appendChild(document.createRange().createContextualFragment(t.data["CAPTCHA_frontend_login_html"])),e.CAPTCHA_response_name=t.data["CAPTCHA_front_end_response_field"]})).catch((function(e){console.log(e)})),""!==e.CAPTCHA_response_name&&0===document.getElementsByName(e.CAPTCHA_response_name).length&&s.a.get(this.api_path+"login",{params:{get_CAPTCHA:"p"}}).then((function(e){document.getElementsByClassName("CAPTCHAfield")[0].appendChild(document.createRange().createContextualFragment(e.data["CAPTCHA_frontend_login_html"]))})).catch((function(e){console.log(e)})),s.a.get(this.api_path+"CAPTCHA",{params:{session_id:this.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.CAPTCHA_enable_p=t.data["p"]["CAPTCHA_enable"],e.CAPTCHA_enable_g=t.data["g"]["CAPTCHA_enable"],e.CAPTCHA_front_end_response_field=t.data["g"]["CAPTCHA_front_end_response_field"],e.CAPTCHA_verify_api=JSON.stringify(t.data["g"]["CAPTCHA_verify_api"],null,4),e.CAPTCHA_frontend_head_html=t.data["g"]["CAPTCHA_frontend_head_html"],e.CAPTCHA_frontend_login_html=t.data["g"]["CAPTCHA_frontend_login_html"],e.CAPTCHA_verify_func=t.data["g"]["CAPTCHA_verify_api_check_function"]})).catch((function(e){console.log(e)})).finally((function(){e.CAPTCHA_verify_func_change()})),s.a.get(this.api_path+"Info",{params:{session_id:this.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.appName=t.data["appName"],e.redirect_uri=""===t.data["redirect_uri"]?e.api_path+"setCode":t.data["redirect_uri"],e.maxAllowedLicense=t.data["maxAllowedLicense"],e.secret=t.data["secret"],e.client_id=t.data["client_id"],e.secret.length+e.client_id.length>0&&(e.CIDaS_color="blue"),e.code=t.data["code"],e.access_token=t.data["access_token"],e.refresh_token=t.data["refresh_token"],e.login_success=!0,e.domains=t.data["allDomains"],e.selected_domains=t.data["availableDomains"],e.licences=t.data["allLicences"],e.selected_licences=t.data["availableLicences"],"admin"===e.password_in&&(e.setPassword_color="red",e.Old_password=e.password_in,e.old_password_type="text")})).catch((function(t){console.log(t),e.login_success=!1}))},setInfo:function(){var e=this;this.setInfo_loading=!0,s.a.put(this.api_path+"Info",null,{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),newInfo:{appName:e.appName,redirect_uri:e.redirect_uri}}}).then((function(){e.setInfo_color="green",e.setInfo_icon="mdi-checkbox-marked-circle-outline",e.updatePage()})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.setInfo_loading=!1}))},CIDaS:function(){var e=this;if(this.CIDaS_loading=!0,-1===e.secret.indexOf("...(not showing)...")||-1===e.client_id.indexOf("...(not showing)...")){var t={session_id:this.$getCookie(e.cookie_prefix+"session_id")};-1===e.secret.indexOf("...(not showing)...")&&(t["secret"]=e.secret),-1===e.client_id.indexOf("...(not showing)...")&&(t["client_id"]=e.client_id),s.a.put(this.api_path+"setSecretId",null,{params:t}).then((function(){e.CIDaS_color="green",e.CIDaS_icon="mdi-checkbox-marked-circle-outline",e.updatePage()})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.CIDaS_loading=!1}))}else e.CIDaS_color="green",e.CIDaS_icon="mdi-checkbox-marked-circle-outline",e.CIDaS_loading=!1},prepareRedirect2GetSecretUrl:function(){var e=this;s.a.get(this.api_path+"getSecretIdUrl",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.redirect2GetSecretUrl_url=t.data})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)}))},prepareRedirect2GetCodeUrl:function(){var e=this;e.prepareRedirect2GetCodeUrl_loading=!0,s.a.get(this.api_path+"waitCodeSet",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(){e.redirect2GetCodeUrl_url=void 0,e.updatePage(),e.initToken()})).catch((function(t){console.log(t),t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.redirect2GetCodeUrl_url=void 0,e.error_msg_bool=!0,console.log(t)})).finally((function(){e.redirect2GetCodeUrl_url=void 0,e.prepareRedirect2GetCodeUrl_loading=!1})),s.a.get(this.api_path+"getCodeURL",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(t){e.redirect2GetCodeUrl_url=t.data})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)}))},initToken:function(){var e=this;this.InitToken_loading=!0,-1===e.code.indexOf("...(not showing)...")&&0!==e.code.length?s.a.put(this.api_path+"Info",null,{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),newInfo:{code:e.code}}}).then((function(){e.setInfo_color="green",e.setInfo_icon="mdi-checkbox-marked-circle-outline",e.updatePage()})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.initToken_step2()})):e.initToken_step2()},initToken_step2:function(){var e=this;s.a.get(this.api_path+"initToken",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id")}}).then((function(){e.InitToken_color="green",e.InitToken_icon="mdi-checkbox-marked-circle-outline",e.updatePage(),e.refreshRegInfo()})).catch((function(t){t.response?(console.log(t.response),void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data)):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.InitToken_loading=!1}))},refreshToken:function(){var e=this;this.RefreshToken_loading=!0,s.a.get(this.api_path+"testInit",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),force:!0}}).then((function(){e.RefreshToken_icon="mdi-checkbox-marked-circle-outline",e.updatePage()})).catch((function(t){t.response?(console.log(t.response),void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data)):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.RefreshToken_loading=!1}))},refreshRegInfo:function(){var e=this;this.RefreshRegInfo_loading=!0,s.a.get(this.api_path+"refreshRegInfo",{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),force:!0}}).then((function(){e.updatePage()})).catch((function(t){t.response?(console.log(t.response),void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data)):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.RefreshRegInfo_loading=!1}))},setDomainsAndLicences:function(){var e=this;this.setDomainsAndLicences_loading=!0;var t={session_id:e.$getCookie(e.cookie_prefix+"session_id"),availableDomains:JSON.stringify(e.selected_domains),availableLicences:JSON.stringify(e.selected_licences),maxAllowedLicense:e.maxAllowedLicense};console.log(t),s.a.put(this.api_path+"setDomainsAndLicences",null,{params:t}).then((function(){e.setDomainsAndLicences_color="green",e.setDomainsAndLicences_icon="mdi-checkbox-marked-circle-outline",e.updatePage()})).catch((function(t){t.response?(console.log(t.response),void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data)):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.setDomainsAndLicences_loading=!1}))},Admin_setting:function(){},setCAPTCHA:function(){var e=this,t={CAPTCHA_enable:this.CAPTCHA_enable_p,CAPTCHA_front_end_response_field:this.CAPTCHA_front_end_response_field,CAPTCHA_verify_api:JSON.parse(this.CAPTCHA_verify_api),CAPTCHA_frontend_head_html:this.CAPTCHA_frontend_head_html,CAPTCHA_frontend_login_html:this.CAPTCHA_frontend_login_html,CAPTCHA_verify_api_check_function:e.CAPTCHA_verify_func},r=JSON.parse(JSON.stringify(t));r["CAPTCHA_enable"]=this.CAPTCHA_enable_g,this.setCAPTCHA_loading=!0,s.a.put(this.api_path+"CAPTCHA",null,{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),new_config:{p:t,g:r}}}).then((function(){e.setCAPTCHA_color="green",e.setCAPTCHA_icon="mdi-checkbox-marked-circle-outline"})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.setCAPTCHA_loading=!1,e.updatePage()}))},CAPTCHA_verify_api_change:function(){this.CAPTCHA_verify_api_pass_btn=!1;try{JSON.parse(this.CAPTCHA_verify_api),this.delay_CAPTCHA_verify_api_change()}catch(e){this.CAPTCHA_verify_api_pass=e.toString()}},delay_CAPTCHA_verify_api_change:b()((function(){this.CAPTCHA_verify_api_change_server_check()}),500),CAPTCHA_verify_api_change_server_check:function(){var e=this;s.a.get(this.api_path+"CAPTCHA",{params:{session_id:this.$getCookie(this.cookie_prefix+"session_id"),test_req_params:"p",test_req_body:e.CAPTCHA_verify_api}}).then((function(){e.CAPTCHA_verify_api_pass=!0,e.CAPTCHA_verify_api_pass_btn=!0})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?e.CAPTCHA_verify_api_pass=t.response.data["error"]+": "+t.response.data["error_description"]:e.CAPTCHA_verify_api_pass=t.response.data:(console.log(t),e.CAPTCHA_verify_api_pass="Network Error.")})).finally((function(){}))},CAPTCHA_verify_func_change:function(){this.CAPTCHA_verify_func_pass_btn="Waiting for server check...",this.delay_check_verify_func()},delay_check_verify_func:b()((function(){this.check_verify_func()}),100),check_verify_func:function(){var e=this;s.a.get(this.api_path+"CAPTCHA",{params:{session_id:this.$getCookie(this.cookie_prefix+"session_id"),test_func:"p",test_func_body:this.CAPTCHA_verify_func}}).then((function(){e.CAPTCHA_verify_func_pass=!0,e.CAPTCHA_verify_func_pass_btn=!0})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?e.CAPTCHA_verify_func_pass=t.response.data["error"]+": "+t.response.data["error_description"]:e.CAPTCHA_verify_func_pass=t.response.data:(console.log(t),e.CAPTCHA_verify_func_pass="Network Error.")})).finally((function(){}))},setPassword:function(){var e=this;s.a.put(this.api_path+"login",null,{params:{session_id:e.$getCookie(e.cookie_prefix+"session_id"),password:e.New_password,password_old:e.Old_password}}).then((function(){e.Old_password="",e.New_password="",window.location.reload()})).catch((function(t){t.response?void 0!=t.response.data["error_description"]?(e.error_msg_title=t.response.data["error"],e.error_msg=t.response.data["error_description"].replace(/\n/g,"<br/>")):(e.error_msg_title="Error",e.error_msg=t.response.data):(e.error_msg_title="Error",e.error_msg=t.toString()),e.error_msg_bool=!0,console.log(t)})).finally((function(){e.updatePage()}))}}},ee=z,te=(r("0156"),r("5bc1")),re=r("8860"),ne=r("da13"),oe=r("1800"),se=r("5d23"),ie=r("f774"),ae=r("b73d"),ce=r("a844"),le=Object(u["a"])(ee,Y,Q,!1,null,null,null),de=le.exports;y()(le,{VApp:w["a"],VAppBar:H["a"],VAppBarNavIcon:te["a"],VBtn:B["a"],VCard:I["a"],VCardActions:L["a"],VCardText:L["b"],VCol:E["a"],VContainer:R["a"],VDivider:G["a"],VForm:O["a"],VIcon:U["a"],VList:re["a"],VListItem:ne["a"],VListItemAction:oe["a"],VListItemContent:se["a"],VListItemTitle:se["b"],VMain:M["a"],VNavigationDrawer:ie["a"],VOverlay:j["a"],VRow:$["a"],VSelect:F["a"],VSpacer:K["a"],VSwitch:ae["a"],VTextField:q["a"],VTextarea:ce["a"]}),n["a"].use(g["a"]);var _e=[{path:"/",name:"Home",component:Z},{path:"/admin",name:"Admin",component:de},{path:"/about",name:"About",component:function(){return r.e("about").then(r.bind(null,"f820"))}}],ue=new g["a"]({routes:_e}),pe=ue,me=r("2f62");n["a"].use(me["a"]);var ge=new me["a"].Store({state:{},mutations:{},actions:{},modules:{}}),fe=r("f309");n["a"].use(fe["a"]);var he=new fe["a"]({});n["a"].prototype.$ajax=s.a,window._=r("2ef0"),n["a"].prototype.$urlBase=location.protocol+"//"+location.hostname+":10000",n["a"].prototype.$setCookie=function(e,t,r){var n=new Date;n.setDate(n.getDate()+r),document.cookie="".concat(e,"=").concat(escape(t),"; expires=").concat(r?n.toGMTString():"",";")},n["a"].prototype.$getCookie=function(e){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),r=document.cookie.match(t);return r?r[2]:null},n["a"].prototype.$delCookie=function(e){var t=new Date;t.setTime(t.getTime()-1);var r=n["a"].prototype.$getCookie(e);null!=r&&(document.cookie="".concat(e,"=").concat(r,"; expires=").concat(t.toGMTString()))},n["a"].config.productionTip=!1,new n["a"]({router:pe,store:ge,vuetify:he,render:function(e){return e(m)}}).$mount("#app")}});
//# sourceMappingURL=app.a65686d8.js.map